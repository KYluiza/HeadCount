function onOpen() {
  const ui = SpreadsheetApp.getUi();
  
  // Menu principal ‚ÄúüßÆ Gest√£o‚Äù
  ui.createMenu('üßÆ Gest√£o')
    .addItem('‚ú® Proje√ß√£o inicial Sales',         'executarProjecaoSales')
    .addItem('‚ú® Proje√ß√£o p√≥s movimentos Sales',  'calcularBudgetPosMovimentos')
    .addItem('‚úîÔ∏è Fechar Contrata√ß√£o Sales',       'abrirVagas')
    .addSeparator()
    .addItem('üßº Limpar Proje√ß√£o Sales',          'limparProjecaoSales')
    .addToUi();
}

function executarProjecaoSales() {
  try {
    Gesto.calcularProjecaoCompleta('sales');
    SpreadsheetApp.getUi().alert('‚úÖ Proje√ß√£o inicial Sales finalizada!');
  } catch (err) {
    SpreadsheetApp.getUi().alert(`‚ùå Deu ruim ao projetar Sales:\n${err.message}`);
  }
}

function calcularBudgetPosMovimentos() {
  try {
    Gesto.calcularBudgetPosMovimentos('sales'); // notar que passa 'sales' como par√¢metro
    SpreadsheetApp.getUi().alert('‚úÖ C√°lculo do Budget p√≥s movimentos Sales realizado!');
  } catch (err) {
    SpreadsheetApp.getUi().alert(`‚ùå Erro ao Calcular Budget p√≥s movimentos Sales:\n${err.message}`);
  }
}

function abrirVagas() {
  try {
    Gesto.abrirVagas('sales');
    SpreadsheetApp.getUi().alert('‚úÖ Fechar Contrata√ß√£o Sales realizado!');
  } catch (err) {
    SpreadsheetApp.getUi().alert(`‚ùå Erro ao fechar contrata√ß√£o Sales:\n${err.message}`);
  }
}

function limparProjecaoSales() {
  try {
    Gesto.limparProjecao('sales');
    SpreadsheetApp.getUi().alert('‚úÖ Proje√ß√£o Sales limpa e protegida!');
  } catch(err) {
    SpreadsheetApp.getUi().alert(`‚ùå Erro ao limpar proje√ß√£o Sales:\n${err.message}`);
  }
}
